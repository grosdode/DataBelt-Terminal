/*!chartjs-plugin-zoom; http://chartjs.org/; Version: 0.7.4; Copyright 2019 Chart.js Contributors; Released under the MIT license; https://github.com/chartjs/chartjs-plugin-zoom/blob/master/LICENSE.md  */
!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o(require("chart.js"),require("hammerjs")):"function"==typeof define&&define.amd?define(["chart.js","hammerjs"],o):(e=e||self).ChartZoom=o(e.Chart,e.Hammer)}(this,function(e,o){"use strict";function t(e,o){var t={};void 0!==e.options.pan&&(t.pan=e.options.pan),void 0!==e.options.pan&&(t.zoom=e.options.zoom);var n=e.$zoom;o=n._options=d.merge({},[o,t]);var a=n._node,i=o.zoom&&o.zoom.enabled,m=o.zoom.drag;i&&!m?a.addEventListener("wheel",n._wheelHandler):a.removeEventListener("wheel",n._wheelHandler),i&&m?(a.addEventListener("mousedown",n._mouseDownHandler),a.ownerDocument.addEventListener("mouseup",n._mouseUpHandler)):(a.removeEventListener("mousedown",n._mouseDownHandler),a.removeEventListener("mousemove",n._mouseMoveHandler),a.ownerDocument.removeEventListener("mouseup",n._mouseUpHandler))}function n(e){var o=e.$zoom._originalOptions;d.each(e.scales,function(e){o[e.id]||(o[e.id]=d.clone(e.options))}),d.each(o,function(t,n){e.scales[n]||delete o[n]})}function a(e,o){return void 0===e||"string"==typeof e&&-1!==e.indexOf(o)}function i(e,o){if(e.scaleAxes&&e.rangeMax&&!d.isNullOrUndef(e.rangeMax[e.scaleAxes])){var t=e.rangeMax[e.scaleAxes];o>t&&(o=t)}return o}function m(e,o){if(e.scaleAxes&&e.rangeMin&&!d.isNullOrUndef(e.rangeMin[e.scaleAxes])){var t=e.rangeMin[e.scaleAxes];o<t&&(o=t)}return o}function r(e,o,t,n){var a=e.max-e.min,r=a*(o-1),l=e.isHorizontal()?t.x:t.y,s=(e.getValueForPixel(l)-e.min)/a,c=r*s,u=r*(1-s);e.options.ticks.min=m(n,e.min+c),e.options.ticks.max=i(n,e.max-u)}function l(e,o,t,n){var a=f[e.type];a&&a(e,o,t,n)}function s(e,o,t,i,m){var r=e.chartArea;i||(i={x:(r.left+r.right)/2,y:(r.top+r.bottom)/2});var s=e.$zoom._options.zoom;if(s.enabled){n(e);var c,u="function"==typeof s.mode?s.mode({chart:e}):s.mode;c="xy"===u&&void 0!==m?m:"xy",d.each(e.scales,function(e){e.isHorizontal()&&a(u,"x")&&a(c,"x")?(s.scaleAxes="x",l(e,o,i,s)):!e.isHorizontal()&&a(u,"y")&&a(c,"y")&&(s.scaleAxes="y",l(e,t,i,s))}),e.update(0),"function"==typeof s.onZoom&&s.onZoom({chart:e})}}function c(e,o,t){var n,a=e.options.ticks,i=e.min,m=e.max,r=e.getValueForPixel(e.getPixelForValue(i)-o),l=e.getValueForPixel(e.getPixelForValue(m)-o),s=r=r.valueOf?r.valueOf():r,c=l=l.valueOf?l.valueOf():l;t.scaleAxes&&t.rangeMin&&!d.isNullOrUndef(t.rangeMin[t.scaleAxes])&&(s=t.rangeMin[t.scaleAxes]),t.scaleAxes&&t.rangeMax&&!d.isNullOrUndef(t.rangeMax[t.scaleAxes])&&(c=t.rangeMax[t.scaleAxes]),r>=s&&l<=c?(a.min=r,a.max=l):r<s?(n=i-s,a.min=s,a.max=m-n):l>c&&(n=c-m,a.max=c,a.min=i+n)}function u(e,o,t){var n=v[e.type];n&&n(e,o,t)}e=e&&e.hasOwnProperty("default")?e.default:e,o=o&&o.hasOwnProperty("default")?o.default:o;var d=e.helpers,p=e.Zoom=e.Zoom||{},f=p.zoomFunctions=p.zoomFunctions||{},v=p.panFunctions=p.panFunctions||{};e.Zoom.defaults=e.defaults.global.plugins.zoom={pan:{enabled:!1,mode:"xy",speed:20,threshold:10},zoom:{enabled:!1,mode:"xy",sensitivity:3,speed:.1}},p.zoomFunctions.category=function(e,o,t,n){var a=e.chart.data.labels,r=e.minIndex,l=a.length-1,s=e.maxIndex,c=n.sensitivity,u=e.isHorizontal()?e.left+e.width/2:e.top+e.height/2,d=e.isHorizontal()?t.x:t.y;p.zoomCumulativeDelta=o>1?p.zoomCumulativeDelta+1:p.zoomCumulativeDelta-1,Math.abs(p.zoomCumulativeDelta)>c&&(p.zoomCumulativeDelta<0?(d>=u?r<=0?s=Math.min(l,s+1):r=Math.max(0,r-1):d<u&&(s>=l?r=Math.max(0,r-1):s=Math.min(l,s+1)),p.zoomCumulativeDelta=0):p.zoomCumulativeDelta>0&&(d>=u?r=r<s?r=Math.min(s,r+1):r:d<u&&(s=s>r?s=Math.max(r,s-1):s),p.zoomCumulativeDelta=0),e.options.ticks.min=m(n,a[r]),e.options.ticks.max=i(n,a[s]))},p.zoomFunctions.time=function(e,o,t,n){r(e,o,t,n),e.options.time.min=e.options.ticks.min,e.options.time.max=e.options.ticks.max},p.zoomFunctions.linear=r,p.zoomFunctions.logarithmic=r,p.panFunctions.category=function(e,o,t){var n,a=e.chart.data.labels,r=a.length-1,l=Math.max(e.ticks.length,1),s=t.speed,c=e.minIndex,u=Math.round(e.width/(l*s));p.panCumulativeDelta+=o,c=p.panCumulativeDelta>u?Math.max(0,c-1):p.panCumulativeDelta<-u?Math.min(r-l+1,c+1):c,p.panCumulativeDelta=c!==e.minIndex?0:p.panCumulativeDelta,n=Math.min(r,c+l-1),e.options.ticks.min=m(t,a[c]),e.options.ticks.max=i(t,a[n])},p.panFunctions.time=function(e,o,t){c(e,o,t);var n=e.options;n.time.min=n.ticks.min,n.time.max=n.ticks.max},p.panFunctions.linear=c,p.panFunctions.logarithmic=c,p.panCumulativeDelta=0,p.zoomCumulativeDelta=0;var h={id:"zoom",afterInit:function(e){e.resetZoom=function(){n(e);var o=e.$zoom._originalOptions;d.each(e.scales,function(e){var t=e.options.time,n=e.options.ticks;o[e.id]?(t&&(t.min=o[e.id].time.min,t.max=o[e.id].time.max),n&&(n.min=o[e.id].ticks.min,n.max=o[e.id].ticks.max)):(t&&(delete t.min,delete t.max),n&&(delete n.min,delete n.max))}),e.update()}},beforeUpdate:function(e,o){t(e,o)},beforeInit:function(e,i){e.$zoom={_originalOptions:{}};var m=e.$zoom._node=e.chart.ctx.canvas;t(e,i);var r=e.$zoom._options,l=r.pan&&r.pan.threshold;e.$zoom._mouseDownHandler=function(o){m.addEventListener("mousemove",e.$zoom._mouseMoveHandler),e.$zoom._dragZoomStart=o},e.$zoom._mouseMoveHandler=function(o){e.$zoom._dragZoomStart&&(e.$zoom._dragZoomEnd=o,e.update(0))},e.$zoom._mouseUpHandler=function(o){if(e.$zoom._dragZoomStart){m.removeEventListener("mousemove",e.$zoom._mouseMoveHandler);var t=e.$zoom._dragZoomStart,n=t.target.getBoundingClientRect().left,i=Math.min(t.clientX,o.clientX)-n,r=Math.max(t.clientX,o.clientX)-n,l=t.target.getBoundingClientRect().top,c=Math.min(t.clientY,o.clientY)-l,u=r-i,d=Math.max(t.clientY,o.clientY)-l-c;if(e.$zoom._dragZoomStart=null,e.$zoom._dragZoomEnd=null,!(u<=0&&d<=0)){var p=e.chartArea,f=e.$zoom._options.zoom,v=p.right-p.left,h=a(f.mode,"x")&&u?1+(v-u)/v:1,x=p.bottom-p.top,g=a(f.mode,"y");s(e,h,g&&d?1+(x-d)/x:1,{x:(i-p.left)/(1-u/v)+p.left,y:(c-p.top)/(1-d/x)+p.top}),"function"==typeof f.onZoomComplete&&f.onZoomComplete({chart:e})}}};var c=null;if(e.$zoom._wheelHandler=function(o){var t=o.target.getBoundingClientRect(),n={x:o.clientX-t.left,y:o.clientY-t.top},a=e.$zoom._options.zoom,i=a.speed;o.deltaY>=0&&(i=-i),s(e,1+i,1+i,n),clearTimeout(c),c=setTimeout(function(){"function"==typeof a.onZoomComplete&&a.onZoomComplete({chart:e})},250),o.cancelable&&o.preventDefault()},o){var f,v=new o.Manager(m);v.add(new o.Pinch),v.add(new o.Pan({threshold:l}));var h=function(o){var t=1/f*o.scale,n=o.target.getBoundingClientRect(),a={x:o.center.x-n.left,y:o.center.y-n.top},i=Math.abs(o.pointers[0].clientX-o.pointers[1].clientX),m=Math.abs(o.pointers[0].clientY-o.pointers[1].clientY),r=i/m;s(e,t,t,a,r>.3&&r<1.7?"xy":i>m?"x":"y");var l=e.$zoom._options.zoom;"function"==typeof l.onZoomComplete&&l.onZoomComplete({chart:e}),f=o.scale};v.on("pinchstart",function(){f=1}),v.on("pinch",h),v.on("pinchend",function(e){h(e),f=null,p.zoomCumulativeDelta=0});var x=null,g=null,z=!1,_=function(o){if(null!==x&&null!==g){z=!0;var t=o.deltaX-x,i=o.deltaY-g;x=o.deltaX,g=o.deltaY,function(e,o,t){n(e);var i=e.$zoom._options.pan;if(i.enabled){var m="function"==typeof i.mode?i.mode({chart:e}):i.mode;d.each(e.scales,function(e){e.isHorizontal()&&a(m,"x")&&0!==o?(i.scaleAxes="x",u(e,o,i)):!e.isHorizontal()&&a(m,"y")&&0!==t&&(i.scaleAxes="y",u(e,t,i))}),e.update(0),"function"==typeof i.onPan&&i.onPan({chart:e})}}(e,t,i)}};v.on("panstart",function(e){x=0,g=0,_(e)}),v.on("panmove",_),v.on("panend",function(){x=null,g=null,p.panCumulativeDelta=0,setTimeout(function(){z=!1},500);var o=e.$zoom._options.pan;"function"==typeof o.onPanComplete&&o.onPanComplete({chart:e})}),e.$zoom._ghostClickHandler=function(e){z&&e.cancelable&&(e.stopImmediatePropagation(),e.preventDefault())},m.addEventListener("click",e.$zoom._ghostClickHandler),e._mc=v}},beforeDatasetsDraw:function(e){var o=e.chart.ctx;if(e.$zoom._dragZoomEnd){var t=function(e){for(var o=e.scales,t=Object.keys(o),n=0;n<t.length;n++){var a=o[t[n]];if(a.isHorizontal())return a}}(e),n=function(e){for(var o=e.scales,t=Object.keys(o),n=0;n<t.length;n++){var a=o[t[n]];if(!a.isHorizontal())return a}}(e),i=e.$zoom._dragZoomStart,m=e.$zoom._dragZoomEnd,r=t.left,l=t.right,s=n.top,c=n.bottom;if(a(e.$zoom._options.zoom.mode,"x")){var u=i.target.getBoundingClientRect().left;r=Math.min(i.clientX,m.clientX)-u,l=Math.max(i.clientX,m.clientX)-u}if(a(e.$zoom._options.zoom.mode,"y")){var d=i.target.getBoundingClientRect().top;s=Math.min(i.clientY,m.clientY)-d,c=Math.max(i.clientY,m.clientY)-d}var p=l-r,f=c-s,v=e.$zoom._options.zoom.drag;o.save(),o.beginPath(),o.fillStyle=v.backgroundColor||"rgba(225,225,225,0.3)",o.fillRect(r,s,p,f),v.borderWidth>0&&(o.lineWidth=v.borderWidth,o.strokeStyle=v.borderColor||"rgba(225,225,225)",o.strokeRect(r,s,p,f)),o.restore()}},destroy:function(e){if(e.$zoom){var o=e.$zoom,t=o._node;t.removeEventListener("mousedown",o._mouseDownHandler),t.removeEventListener("mousemove",o._mouseMoveHandler),t.ownerDocument.removeEventListener("mouseup",o._mouseUpHandler),t.removeEventListener("wheel",o._wheelHandler),t.removeEventListener("click",o._ghostClickHandler),delete e.$zoom;var n=e._mc;n&&(n.remove("pinchstart"),n.remove("pinch"),n.remove("pinchend"),n.remove("panstart"),n.remove("pan"),n.remove("panend"),n.destroy())}}};return e.plugins.register(h),h});